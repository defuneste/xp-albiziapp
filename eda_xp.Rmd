---
title: "EDA_XP"
author: "Olivier Leroy"
date: "12 août 2019"
output: 
  bookdown::html_document2:
    toc: TRUE
    fig_caption: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

source("chargement_xp.R")
## chargement des libraries
library(ggplot2)
library(bookdown)
library(sf)
library(ggmap)
library(tmaptools)
library(spatstat)
```


# Présentation du test 

Le test a eu lieu le samedi 29 juin 2019 de 10h30 à 12h00 et regroupait 7 participants. 125 arbres (relevés) ont été effectués entre les participants (figure \@ref(fig:releveactivite)). Le nombre de relevés par participant varie de 10 à 40 arbres. 

## Zone de test

### Localisation et limite de la zone de test

La zone du test (figure : \@ref(fig:zonetest)) a eu lieu à Saint-Etienne dans le quartier Carnot. Elle est délimitée au nord par le campus de Manufacture de l'Université Jean Monet, à l'est par le boulevard Thiers, à l'ouest par la ligne de tramway et au sud par le boulevard Jules Janin. Ce sont des axes simples à reconnaitre même pour quelqu'un de non familier de la zone. 

```{r zonetest, fig.align = 'center', echo=FALSE, message=FALSE, fig.cap="Carte de présentation de la zone de test"}
load(file = "data/xp_st_e.RData")
xp_st_e +
  geom_sf(data = arbre_xp_zone.shp, inherit.aes = FALSE, pch = 16, alpha = 0.7, aes(col = "forestgreen"), size = 0.5, show.legend = "point") +
  geom_point(aes(x = 4.3860717, y = 45.4496287), size = 4, pch = "M") +
  xlab("") + ylab("") +
  labs(caption = "Fonds OSM, rendu Stamen") +
  scale_color_manual(values = c("forestgreen" = "forestgreen"), name = "", labels = "Arbres préalablement identifiés")
```

Cette zone est entièrement couverte par un wifi et dispose de prises de chargement de portables en accès libre. 

### Arbres de la zone de test

Cette zone représente `r round(st_area(zone.shp)/10000, 2)` h. Elle comprend `r nrow(arbre_xp_zone.shp)` arbres soit `r round(nrow(arbre_xp_zone.shp)/round(st_area(zone.shp)/10000, 2),2)` arbres par hectare. 

Il y a entre 41 et 42 genres d'arbres (en fonction d'où on range les macromeles). Prés de 50% des arbres se retrouvent être soit des *Platanus* (une seule espèce) soit des *Prunus* (6 espèces). 62 espèces se répartissent dans ces genres. 

Les arbres sont en moyennes à 11,5 m les uns des autres, avec une médiane de 10,15 m et pour 90% des arbres cette distance est comprise entre 2,5 et 19,93 m. 


## Les 5 activités

Il y a eu 5 activités de proposés : 

* 1 : "Faites 5 relevés"
* 2 : "Faites 3 relevés de genres différents" 
* 3 : "Vérifiez 3 relevés d'un autre utilisateur (cercle vert clignotant)"
* 4 : "Identifiez 3 relevés d'expert (cercle bleu clignotant)"
* 5 : "Faites un maximum de relevé en un temps limite"

Il était aussi possible de faire un relevé hors activité (6). 

Les activités 1 et 2 demandent un nombre précis de relevés pour être validés (respectivement 5 et 3). 

```{r releveactivite, fig.align = 'center', echo = FALSE, fig.cap="Nombre de reĺevés par participants en fonction des activités"}
ggplot(data = xp_bota.shp, aes(x = participant)) +
  geom_bar(aes(fill = code_activ)) + # penser à changer la couleur
  labs(x ="Participants",
       y ="Nombre de relevés") +
  scale_fill_discrete(name = "Activités") +
  theme_bw() +
  theme( 
    panel.grid.major.x = element_blank() # ici c'est juste pour supprimer les lignes verticales
  )
```


## Travail sur les données 

